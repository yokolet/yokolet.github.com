<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 class="has-navbar-fixed-top">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>
    <link rel="stylesheet" href="/assets/css/prism.css">
    <link rel="stylesheet" href="/assets/css/tabs.css">
    <link rel="stylesheet" href="/assets/css/accordion.css">
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/assets/img/favicon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Bun + React on Rails | yokolet’s notelets</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Bun + React on Rails" />
<meta name="author" content="Yoko Harada" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the frontend world, new technologies keep emerging rapidly these years. Still, React is a well-established and very popular frontend framework, Vue.js, Svelte, Astro and more frameworks are gaining popularity. Not just the frameworks, tools for a transpiler/bundler or sort are also under a rapid development. In JavaScript domain, esbuild, rollup, vite and some more are out." />
<meta property="og:description" content="In the frontend world, new technologies keep emerging rapidly these years. Still, React is a well-established and very popular frontend framework, Vue.js, Svelte, Astro and more frameworks are gaining popularity. Not just the frameworks, tools for a transpiler/bundler or sort are also under a rapid development. In JavaScript domain, esbuild, rollup, vite and some more are out." />
<link rel="canonical" href="http://localhost:4000/2024/03/01/bun-react-on-rails.html" />
<meta property="og:url" content="http://localhost:4000/2024/03/01/bun-react-on-rails.html" />
<meta property="og:site_name" content="yokolet’s notelets" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-03-01T15:31:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bun + React on Rails" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yoko Harada"},"dateModified":"2024-03-01T15:31:00+09:00","datePublished":"2024-03-01T15:31:00+09:00","description":"In the frontend world, new technologies keep emerging rapidly these years. Still, React is a well-established and very popular frontend framework, Vue.js, Svelte, Astro and more frameworks are gaining popularity. Not just the frameworks, tools for a transpiler/bundler or sort are also under a rapid development. In JavaScript domain, esbuild, rollup, vite and some more are out.","headline":"Bun + React on Rails","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2024/03/01/bun-react-on-rails.html"},"url":"http://localhost:4000/2024/03/01/bun-react-on-rails.html"}</script>
<!-- End Jekyll SEO tag -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-761764-8"></script>
<script>
  window['ga-disable-UA-761764-8'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-761764-8');
</script><!-- head scripts --></head>

  <body>
    <nav class="navbar is-primary  is-fixed-top " x-data="{ openNav: false }">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
                yokolet's notelets
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <a href="/blog/" class="navbar-item ">Blog</a>
                    
                
                    
                    <a href="/algo/" class="navbar-item ">Algo</a>
                    
                
                    
                    <a href="/about/" class="navbar-item ">About</a>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <section class="hero  is-small  is-bold is-primary" >
    <div class="hero-body ">
        <div class="container">
            <h1 class="title is-2">Bun + React on Rails</h1>
            <p class="subtitle is-3"></p>
            
        </div>
    </div>
</section>
    
    


    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-8">
                    
                    
                    
                    
                    <div class="content">

    <p>Published: Mar 1, 2024</p>

    <div class="tags">
        
    </div>

    

    <p>In the frontend world, new technologies keep emerging rapidly these years.
Still, React is a well-established and very popular frontend framework,
Vue.js, Svelte, Astro and more frameworks are gaining popularity.
Not just the frameworks, tools for a transpiler/bundler or sort are also under a rapid development.
In JavaScript domain, esbuild, rollup, vite and some more are out.</p>

<p>Relatively new addition is Bun (<a href="https://bun.sh/">https://bun.sh/</a>).</p>

<p>Bun has multiple features.
It can be used as a package manager, development server, bundler and test runner.
On the website, it says an all-in-one toolkit for JavaScript.
The best advantage of using Bun would be its speed.
Indeed, Bun runs very fast.</p>

<p>Rails supports Bun since version 7.1 as one of JavaScript approaches.
This blog post is about the attempt to create a React app using Bun.</p>

<h4 id="prerequisite">Prerequisite</h4>

<p>Prior to the Rails application creation, <code>bun</code> command should be installed.
The installation instruction is on the Bun website, <a href="https://bun.sh/docs/installation">https://bun.sh/docs/installation</a>.
The website shows 5 ways to install bun if you have macOS and Linux.
Among those, by curl command, Homebrew and npm would be popular.
Choose whatever you like.</p>

<ul>
  <li>curl
    <pre><code class="language-bash">$ curl -fsSL https://bun.sh/install | bash # for macOS, Linux, and WSL
</code></pre>
  </li>
  <li>Homebrew
    <pre><code class="language-bash">$ brew install oven-sh/bun/bun # for macOS and Linux
</code></pre>
  </li>
  <li>npm
    <pre><code class="language-bash">$ npm install -g bun # the last `npm` command you'll ever need
</code></pre>
  </li>
</ul>

<p>The Bun website also has an instruction for Windows.</p>

<h4 id="versions">Versions</h4>
<ul>
  <li>Ruby 3.2.3</li>
  <li>Rails 7.1.3.2</li>
</ul>

<h3 id="create-a-rails-app-with-bun-option">Create a Rails App with bun Option</h3>

<p>The command to create an app which uses bun is something like this:</p>

<pre><code class="language-bash">% rails new [APP NAME] -j bun -T
</code></pre>

<p>Above command installs all including <code>bun install</code>.
After the installation finishes, change the directory to application and just type <code>bin/dev</code>.
The Rails should start up.
Verify that by visiting http://localhost:3000/ on a browser.</p>

<p>In early releases of Rail 7.1, some odds were reported to start the Rails.
However, on version 7.1.3.2, all those issues look fixed.
None of extra steps are required to start Rails now.</p>

<h3 id="files-related-to-bun">Files Related to Bun</h3>

<p>Let’s look at files in the Rails application top directory.</p>
<h4 id="bunlockb">bun.lockb</h4>
<p>This file is a lock file equivalent to package-lock.json or yarn.lock.
Unlike a legacy lock file, bun.lockb is a binary file.</p>

<h4 id="bunconfigjs">bun.config.js</h4>
<p>This is a Bun configuration file which defines how Bun builds the application.
When the Rails generator created the file, a build configuration is defined like this:</p>
<pre><code class="language-javascript">const config = {
  sourcemap: "external",
  entrypoints: ["app/javascript/application.js"],
  outdir: path.join(process.cwd(), "app/assets/builds"),
};
</code></pre>

<p>The details of the configuration parameters are explained at <a href="https://bun.sh/docs/bundler#api">https://bun.sh/docs/bundler#api</a>.</p>

<p>For example, to minify output JavaScript files, the configuration will be:</p>
<pre><code class="language-javascript">const config = {
  sourcemap: "external",
  entrypoints: ["app/javascript/application.js"],
  outdir: path.join(process.cwd(), "app/assets/builds"),
  minify: true,
};
</code></pre>
<p>We see more than ten configuration APIs on the web page.
However, not many options work seamlessly with Rails.
Suppose the naming setting is changed to <code>naming: '[dir]/[name]-[hash].[ext]'</code>
(default for the entry is ‘[dir]/[name].[ext]’),
the generated JavaScript file will be something like <code>application-6da4a92fc66938e4.js</code>.
It looks good at a glance.
However, javascript_include_tag in app/views/layouts/application.html.erb should be changed like
<code>&lt;%= javascript_include_tag "application-6da4a92fc66938e4", "data-turbo-track": "reload", type: "module" %&gt;</code>.
When the JavaScript file is updated, the hash value will be updated as well.
As a result, the outdir will have multiple <code>application-[hash].js</code> files.
Also, javascript_include_tag’s filename should be updated accordingly.
Moreover, Rails adds a hash value when the JavaScript file is provided.
It is something like, <code>application-921e7020b343a6ac4bfb2c1d2302254e1f5ea0fda39e8ee8c38aa17e00d8e0e2.js</code>.</p>

<p>Although Bun configuration API has many options, only few are useful on Rails.</p>

<h4 id="procfiledev">Procfile.dev</h4>

<p>The file is a server setting passed to Foreman.
When the Rails application is created with <code>-j bun</code> option, the file looks like below:</p>
<pre><code class="language-bash">web: env RUBY_DEBUG_OPEN=true bin/rails server
js: bun run build --watch
</code></pre>

<p>Bun’s <code>--watch</code> options is explained at Watch mode (<a href="https://bun.sh/docs/runtime/hot">https://bun.sh/docs/runtime/hot</a>).
When the option is specified, Bun watches changes in JavaScript files listed in the entrypoints configuration.
If Bun detects a change, Bun restarts the process.</p>

<p>Another option is <code>--hot</code>. However, <code>--hot</code> option works when Bun is used on the server side.
Besides, as above web page explains, the option is not for a hot loading to the browser.
When the JavaScript code is updated, still we need to click browser’s reload button.
The hot loading to the browser will be a job by <a href="https://vitejs.dev/">Vite</a>.</p>

<h3 id="create-a-react-app">Create a React App</h3>

<p>The first step is to install packages.</p>

<pre><code class="language-bash">$ bun add react react-dom
</code></pre>

<p>You might be surprised. Bun runs really fast.</p>

<p>Next step is to write React code.
For a simplicity, the React app used here is the one create-react-app package creates.
The app shows a rotating React logo and a couple other messages.
JavaScript code can be used as those are except image and stylesheet imports.
Since the server side is Rails, it’s good and easy to put images and stylesheets in the directories meant to be.
For that reason, the sample app takes idiomatic Rails rather than idiomatic React.</p>

<ul>
  <li>app/javascript/application.js</li>
</ul>

<p>The entrypoint file is index.js on a generated React app, while it is application.js on Rails.
Replace the contents of <code>app/javascript/application.js</code> by index.js.</p>

<pre><code class="language-javascript">import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  &lt;React.StrictMode&gt;
    &lt;App /&gt;
  &lt;/React.StrictMode&gt;
);
</code></pre>

<ul>
  <li>app/javascript/App.js</li>
</ul>

<p>This is an App component. Other than stylesheet and image imports, the code stays the same as React app.</p>

<pre><code class="language-javascript">function App() {
  return (
    &lt;div className="App"&gt;
      &lt;header className="App-header"&gt;
        &lt;img src="/assets/logo.svg" className="App-logo" alt="logo" /&gt;
        &lt;p&gt;
          Edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.
        &lt;/p&gt;
        &lt;a
          className="App-link"
          href="https://reactjs.org"
          target="_blank"
          rel="noopener noreferrer"
        &gt;
          Learn React
        &lt;/a&gt;
      &lt;/header&gt;
    &lt;/div&gt;
  );
}

export default App;
</code></pre>

<ul>
  <li>index.css, App.css and logo.svg</li>
</ul>

<p>Copy two css files under app/assets/stylesheets. No need to edit those.
Also, copy logo.svg under app/assets/images.</p>

<p>The directory structures become look like below.</p>

<pre><code>app/javascript
├── App.js
├── application.js
└── controllers
    ├── application.js
    ├── hello_controller.js
    └── index.js

2 directories, 5 files
</code></pre>

<pre><code>app/assets
├── builds
│   ├── application.js
│   └── application.js.map
├── config
│   └── manifest.js
├── images
│   └── logo.svg
└── stylesheets
    ├── App.css
    ├── application.css
    └── index.css

5 directories, 7 files
</code></pre>

<h3 id="create-a-mount-point">Create a Mount Point</h3>

<p>Since this is a Rails app, a controller is responsible to receive HTTP requests.
To show the React app on a browser, the controller for that should be created along with a view.</p>

<pre><code class="language-bash">$ rails g controller pages index
</code></pre>

<p>Above command creates a controller and view, also adds a new route in config/routes.rb</p>

<ul>
  <li>app/view/pages/index.html.erb</li>
</ul>

<p>In the app/javascript/application.js, “root” is specified as a mount point.
Add a div tag in the index.html.erb file.</p>

<pre><code class="language-html">&lt;h1&gt;Pages#index&lt;/h1&gt;
&lt;p&gt;Find me in app/views/pages/index.html.erb&lt;/p&gt;
&lt;%= content_tag(:div, "", id:"root") %&gt;
</code></pre>

<h3 id="run-the-app">Run the app</h3>

<p>All are ready. Let’s run the app.</p>

<pre><code class="language-bash">$ bin/dev
</code></pre>

<p>Then go to http://localhost:3000/pages/index on the browser.
The React app shows up.</p>

<p><img width="300px" src="http://localhost:4000/assets/img/rails-bun-react.jpeg" alt="img: bun + react on rails" /></p>

<h3 id="references">References</h3>
<ul>
  <li><a href="https://bun.sh/docs">https://bun.sh/docs</a></li>
  <li><a href="https://webcrunch.com/posts/bun-with-ruby-on-rails">How to use Bun with Ruby on Rails</a></li>
  <li>Sample code: <a href="https://github.com/yokolet/rails-bun-react">https://github.com/yokolet/rails-bun-react</a></li>
</ul>

</div>




                </div>
                
                <div class="column is-4-desktop is-4-tablet">
                    <p class="title is-4">Latest Posts</p>

<div class="columns is-multiline">
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/2024/03/05/vite-vue-bun-on-rails.html">Vite + Vue + Bun on Rails</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><p><a href="https://vuejs.org/">Vue.js</a> is one of frontend frameworks gaining popularity among rapidly emerging JavaScript technologies.
The combination of Vue.js and Rails is becoming more popular as well,
however, Vue.js development on Rails is not so straightforward.
The reason would be that Vue.js relies on <a href="https://vitejs.dev/">Vite</a> for a development environment
such as HMR (Hot Module Replacement) and bundling.</p>

</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/2024/03/05/vite-vue-bun-on-rails.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Mar 5, 2024</p>
    </footer>
</div>
    </div>
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/2024/03/01/bun-react-on-rails.html">Bun + React on Rails</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><p>In the frontend world, new technologies keep emerging rapidly these years.
Still, React is a well-established and very popular frontend framework,
Vue.js, Svelte, Astro and more frameworks are gaining popularity.
Not just the frameworks, tools for a transpiler/bundler or sort are also under a rapid development.
In JavaScript domain, esbuild, rollup, vite and some more are out.</p>

</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/2024/03/01/bun-react-on-rails.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Mar 1, 2024</p>
    </footer>
</div>
    </div>
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/2023/09/04/ruby-on-rails-secrets-management.html">Ruby on Rails Secrets Management</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><p>A web application needs various kinds of values, params and etc which should not be revealed to the public, say GitHub repo.
For example, API keys, tokens, passwords, and endpoints, all those should be kept secret.
Another important factor is that such secrets should be shared among the team members.
Additionally, all those secrets should come along with the deployment.</p>

</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/2023/09/04/ruby-on-rails-secrets-management.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Sep 4, 2023</p>
    </footer>
</div>
    </div>
    
</div>




                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">

        

        <div class="content is-small has-text-centered">
            <p class="">Theme built by <a href="https://www.csrhymes.com">C.S. Rhymes</a></p>
            <p class=""> Copyright &copy; Yoko Harada</p>
        </div>
    </div>
</footer>
    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts -->
<script src="/assets/js/prism.js" type="text/javascript"></script>
<script src="/assets/js/tabs.js" type="text/javascript"></script>
<script src="/assets/js/accordion.js" type="text/javascript"></script>
<script src="https://kit.fontawesome.com/62ce2f5610.js" crossorigin="anonymous"></script>
</body>
</html>
