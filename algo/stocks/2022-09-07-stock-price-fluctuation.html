<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 class="has-navbar-fixed-top">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <link rel="stylesheet" href="/assets/css/prism.css">
    <link rel="stylesheet" href="/assets/css/tabs.css">
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/assets/img/favicon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Stock Price Fluctuation | yokolet’s notelets</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Stock Price Fluctuation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Blog site mostly for programming topics." />
<meta property="og:description" content="Blog site mostly for programming topics." />
<link rel="canonical" href="http://localhost:4000/algo/stocks/2022-09-07-stock-price-fluctuation.html" />
<meta property="og:url" content="http://localhost:4000/algo/stocks/2022-09-07-stock-price-fluctuation.html" />
<meta property="og:site_name" content="yokolet’s notelets" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-07T15:42:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Stock Price Fluctuation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-07T15:42:00+09:00","datePublished":"2022-09-07T15:42:00+09:00","description":"Blog site mostly for programming topics.","headline":"Stock Price Fluctuation","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/algo/stocks/2022-09-07-stock-price-fluctuation.html"},"url":"http://localhost:4000/algo/stocks/2022-09-07-stock-price-fluctuation.html"}</script>
<!-- End Jekyll SEO tag -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-761764-8"></script>
<script>
  window['ga-disable-UA-761764-8'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-761764-8');
</script><!-- head scripts --></head>

  <body>
    <nav class="navbar is-primary  is-fixed-top " x-data="{ openNav: false }">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
                yokolet's notelets
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <a href="/blog/" class="navbar-item ">Blog</a>
                    
                
                    
                    <a href="/algo/" class="navbar-item ">Algo</a>
                    
                
                    
                    <a href="/about/" class="navbar-item ">About</a>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <section class="hero  is-small  is-bold is-primary" >
    <div class="hero-body ">
        <div class="container">
            <h1 class="title is-2">Stock Price Fluctuation</h1>
            <p class="subtitle is-3"></p>
            
        </div>
    </div>
</section>
    
    


    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-12">
                    
                    
                    
                    
                    <div class="content">

    <p>Published: Sep 7, 2022</p>

    

    <h2 id="introduction">Introduction</h2>
<p>This problem is a different type of stocks.
Stock prices are coming in one by one from data stream.
It means this is an online algorithm type.
Additionally, this is a design problem.
A class template is given with empty constructor and methods.</p>

<h2 id="problem-description">Problem Description</h2>
<blockquote>
  <p>You are given a stream of <code>record</code>s about a particular stock.
Each record contains a <code>timestamp</code> and the corresponding <code>price</code> of the stock at that timestamp.<br />
Unfortunately due to the volatile nature of the stock market, the records do not come in order.
Even worse, some records may be incorrect.
Another record with the same timestamp may appear later in the stream correcting the price of
the previous wrong record.</p>

  <p>Design an algorithm that:</p>

  <ul>
    <li>Updates the price of the stock at a particular timestamp,
correcting the price from any previous records at the timestamp.</li>
    <li>Finds the latest price of the stock based on the current records.
The latest price is the price at the latest timestamp recorded.</li>
    <li>Finds the maximum price the stock has been based on the current records.</li>
    <li>Finds the minimum price the stock has been based on the current records.</li>
  </ul>

  <p>Implement the StockPrice class:</p>

  <ul>
    <li><code>StockPrice()</code> Initializes the object with no price records.</li>
    <li><code>void update(int timestamp, int price)</code> Updates the price of the stock at the given timestamp.</li>
    <li><code>int current()</code> Returns the latest price of the stock.</li>
    <li><code>int maximum()</code> Returns the maximum price of the stock.</li>
    <li><code>int minimum()</code> Returns the minimum price of the stock.</li>
  </ul>

  <p>Constraints:</p>

  <p><code>1 &lt;= timestamp, price &lt;= 10**9</code><br />
At most <code>10**5</code> calls will be made in total to <code>update</code>, <code>current</code>, <code>maximum</code>, and <code>minimum</code>.
<code>current</code>, <code>maximum</code>, and <code>minimum</code> will be called only after <code>update</code> has been called at least once.</p>

  <p><a href="https://leetcode.com/problems/stock-price-fluctuation/">https://leetcode.com/problems/stock-price-fluctuation/</a></p>
</blockquote>

<h2 id="examples">Examples</h2>
<pre><code>Example 1:
Input:
["StockPrice", "update", "update", "current", "maximum", "update", "maximum", "update", "minimum"]
[[], [1, 10], [2, 5], [], [], [1, 3], [], [4, 2], []]
Output:
[null, null, null, 5, 10, null, 5, null, 2]

Explanation:
StockPrice stockPrice = new StockPrice();
stockPrice.update(1, 10); // Timestamps are [1] with corresponding prices [10].
stockPrice.update(2, 5);  // Timestamps are [1,2] with corresponding prices [10,5].
stockPrice.current();     // return 5, the latest timestamp is 2 with the price being 5.
stockPrice.maximum();     // return 10, the maximum price is 10 at timestamp 1.
stockPrice.update(1, 3);  // The previous timestamp 1 had the wrong price, so it is updated to 3.
                          // Timestamps are [1,2] with corresponding prices [3,5].
stockPrice.maximum();     // return 5, the maximum price is 5 after the correction.
stockPrice.update(4, 2);  // Timestamps are [1,2,4] with corresponding prices [3,5,2].
stockPrice.minimum();     // return 2, the minimum price is 2 at timestamp 4.
</code></pre>

<h2 id="analysis">Analysis</h2>
<p>If the problem is the type of online algorithm and asks maximum and/or minimum,
the heap data structure should be used.
The problem asks both maximum and minimum, we need min and max heaps.
To support current value reference, we should keep values in a hash map.</p>

<p>Each method should focus on only necessary operations.
Heap updates will be done when maximum or minimum methods are called.
In max/min heaps, old data are saved.
Those will be eliminated when heap pop result mismatches values in hash map.</p>

<h2 id="solution">Solution</h2>
<pre><code class="language-python">class StockPrice:

    def __init__(self):
        self.curId = -1
        self.d = {}  # id: price
        self.maxheap = [] # (price, id)
        self.minheap = [] # (price, id)


    def update(self, timestamp: int, price: int) -&gt; None:
        self.curId = max(self.curId, timestamp)
        self.d[timestamp] = price
        heapq.heappush(self.maxheap, (-price, timestamp))
        heapq.heappush(self.minheap, (price, timestamp))


    def current(self) -&gt; int:
        return self.d[self.curId]


    def maximum(self) -&gt; int:
        p, id = self.maxheap[0]
        while self.maxheap and self.d[id] != -p:
            heapq.heappop(self.maxheap)
            p, id = self.maxheap[0]
        return -p


    def minimum(self) -&gt; int:
        p, id = self.minheap[0]
        while self.minheap and self.d[id] != p:
            heapq.heappop(self.minheap)
            p, id = self.minheap[0]
        return p
</code></pre>

<h2 id="complexities">Complexities</h2>
<ul>
  <li>Time: <code>O(nlog(n))</code></li>
  <li>Space: <code>O(n)</code></li>
  <li></li>
</ul>

</div>

<div class="tags">
    
    <span class="tag  is-primary ">
    Medium
</span>
    
    <span class="tag  is-primary ">
    Heap
</span>
    
    <span class="tag  is-primary ">
    Hash Table
</span>
    
    <span class="tag  is-primary ">
    Design
</span>
    
    <span class="tag  is-primary ">
    Data Stream
</span>
    
    <span class="tag  is-primary ">
    Ordered Set
</span>
    
</div>




                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">

        

        <div class="content is-small has-text-centered">
            <p class="">Theme built by <a href="https://www.csrhymes.com">C.S. Rhymes</a></p>
            <p class=""> Copyright &copy; Yoko Harada</p>
        </div>
    </div>
</footer>
    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts -->
<script src="/assets/js/prism.js" type="text/javascript"></script>
<script src="/assets/js/tabs.js" type="text/javascript"></script>
<script src="https://kit.fontawesome.com/62ce2f5610.js" crossorigin="anonymous"></script>
</body>
</html>
