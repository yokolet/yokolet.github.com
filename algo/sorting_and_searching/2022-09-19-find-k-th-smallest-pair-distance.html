<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 class="has-navbar-fixed-top">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <link rel="stylesheet" href="/assets/css/prism.css">
    <link rel="stylesheet" href="/assets/css/tabs.css">
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/assets/img/favicon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Find K-th Smallest Pair Distance | yokolet’s notelets</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Find K-th Smallest Pair Distance" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Blog site mostly for programming topics." />
<meta property="og:description" content="Blog site mostly for programming topics." />
<link rel="canonical" href="http://localhost:4000/algo/sorting_and_searching/2022-09-19-find-k-th-smallest-pair-distance.html" />
<meta property="og:url" content="http://localhost:4000/algo/sorting_and_searching/2022-09-19-find-k-th-smallest-pair-distance.html" />
<meta property="og:site_name" content="yokolet’s notelets" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-19T21:37:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Find K-th Smallest Pair Distance" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-19T21:37:00+09:00","datePublished":"2022-09-19T21:37:00+09:00","description":"Blog site mostly for programming topics.","headline":"Find K-th Smallest Pair Distance","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/algo/sorting_and_searching/2022-09-19-find-k-th-smallest-pair-distance.html"},"url":"http://localhost:4000/algo/sorting_and_searching/2022-09-19-find-k-th-smallest-pair-distance.html"}</script>
<!-- End Jekyll SEO tag -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-761764-8"></script>
<script>
  window['ga-disable-UA-761764-8'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-761764-8');
</script><!-- head scripts --></head>

  <body>
    <nav class="navbar is-primary  is-fixed-top " x-data="{ openNav: false }">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
                yokolet's notelets
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <a href="/blog/" class="navbar-item ">Blog</a>
                    
                
                    
                    <a href="/algo/" class="navbar-item ">Algo</a>
                    
                
                    
                    <a href="/about/" class="navbar-item ">About</a>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <section class="hero  is-small  is-bold is-primary" >
    <div class="hero-body ">
        <div class="container">
            <h1 class="title is-2">Find K-th Smallest Pair Distance</h1>
            <p class="subtitle is-3"></p>
            
        </div>
    </div>
</section>
    
    


    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-12">
                    
                    
                    
                    
                    <div class="content">

    <p>Published: Sep 19, 2022</p>

    

    <h2 id="introduction">Introduction</h2>
<p>The solution of this problem might not come up easily.
In fact, the binary search works well to find the answer.
The order of the array doesn’t matter, so the first step is to sort the array.
Then what’s next?
Since the array is sorted, we should think of the possibility of the binary search.
In case of the binary search, the criteria to move left and right pointer is an important key.
Once we figure out the key, we can find the answer.</p>

<h2 id="problem-description">Problem Description</h2>
<blockquote>
  <p>The distance of a pair of integers <code>a</code> and <code>b</code> is defined as the absolute difference between <code>a</code> and <code>b</code>.</p>

  <p>Given an integer array <code>nums</code> and an integer <code>k</code>, 
return the k-th smallest distance among all the pairs <code>nums[i]</code> and <code>nums[j]</code> where <code>0 &lt;= i &lt; j &lt; nums.length</code>.</p>

  <p>Constraints:</p>
  <ul>
    <li><code>n == nums.length</code></li>
    <li><code>2 &lt;= n &lt;= 10**4</code></li>
    <li><code>0 &lt;= nums[i] &lt;= 10**6</code></li>
    <li><code>1 &lt;= k &lt;= n * (n - 1) / 2</code></li>
  </ul>

  <p><a href="https://leetcode.com/problems/find-k-th-smallest-pair-distance/">https://leetcode.com/problems/find-k-th-smallest-pair-distance/</a></p>
</blockquote>

<h2 id="examples">Examples</h2>
<pre><code>Example 1
Input: nums = [1,3,1], k = 1
Output: 0
Explanation: Here are all the pairs:
(1,3) -&gt; 2
(1,1) -&gt; 0
(3,1) -&gt; 2
Then the 1st smallest distance pair is (1,1), and its distance is 0.
</code></pre>

<pre><code>Example 2
Input: nums = [1,1,1], k = 2
Output: 0
</code></pre>

<pre><code>Example 3
Input: nums = [1,6,1], k = 3
Output: 5
</code></pre>

<h2 id="analysis">Analysis</h2>
<p>Since the binary search is the algorithm to solve the problem, start from sorting the given array.
The maximum difference comes from the sorted array’s 0 and the last indices.
This is the initial value of the high pointer.
While searching the optimal value, it counts how many elements have the bigger differences between middle.
When the difference exceeds, the lower index is incremented one.
This way, the check function avoids a double loop.
If the count is greater than or equal to k, the right pointer moves.
Otherwise, the left pointer moves.</p>

<h2 id="solution">Solution</h2>
<pre><code class="language-python">class FindKthSmallestPairDistance:
    def smallestDistancePair(self, nums: List[int], k: int) -&gt; int:
        def check(mid):
            count, idx = 0, 0
            for i, v in enumerate(nums):
                while v - nums[idx] &gt; mid:
                    idx += 1
                count += i - idx
            return count &gt;= k
        
        nums.sort()
        left, right = 0, nums[-1] - nums[0]
        while left &lt; right:
            mid = (left + right) // 2
            if check(mid):
                right = mid
            else:
                left = mid + 1
        return left
</code></pre>

<h2 id="complexities">Complexities</h2>
<ul>
  <li>Time: <code>O(nlog(n))</code></li>
  <li>Space: <code>O(1)</code></li>
</ul>


</div>

<div class="tags">
    
    <span class="tag  is-primary ">
    Hard
</span>
    
    <span class="tag  is-primary ">
    Binary Search
</span>
    
    <span class="tag  is-primary ">
    Two Pointers
</span>
    
    <span class="tag  is-primary ">
    Sorting
</span>
    
    <span class="tag  is-primary ">
    Array
</span>
    
</div>




                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">

        

        <div class="content is-small has-text-centered">
            <p class="">Theme built by <a href="https://www.csrhymes.com">C.S. Rhymes</a></p>
            <p class=""> Copyright &copy; Yoko Harada</p>
        </div>
    </div>
</footer>
    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts -->
<script src="/assets/js/prism.js" type="text/javascript"></script>
<script src="/assets/js/tabs.js" type="text/javascript"></script>
<script src="https://kit.fontawesome.com/62ce2f5610.js" crossorigin="anonymous"></script>
</body>
</html>
